Name: Workflow_39e9
SchemaVersion: "1.0"
Triggers:
  - Type: PUSH
    Branches:
      - main
Actions:
  Build:
    Actions:
      build_backend:
        Identifier: aws/build@v1
        Compute:
          Type: Lambda
        Inputs:
          Sources:
            - WorkflowSource
          Variables:
            - Name: AWS_DEFAULT_REGION
              Value: us-west-2
            - Name: CDK_DEFAULT_ACCOUNT
              Value: "402377214432"
            - Name: CDK_DEFAULT_REGION
              Value: us-west-2
        Outputs:
          AutoDiscoverReports:
            Enabled: true
            ReportNamePrefix: backend
            IncludePaths:
              - "**/*"
            SuccessCriteria:
              PassRate: 100
              BranchCoverage: 50
              LineCoverage: 70
              Vulnerabilities:
                Severity: CRITICAL
          Artifacts:
            - Name: backend
              Files:
                - "**/*"
        Configuration:
          Steps:
            - Run: pip3 install -r requirements-dev.txt
          Container:
            Registry: CODECATALYST
            Image: CodeCatalystLinuxLambda_x86_64:2024_03
        Environment:
          Name: development
      cdk_bootstrap:
        Identifier: aws/cdk-bootstrap@v1
        Environment:
          Name: development
        Inputs:
          Sources:
            - WorkflowSource
        Compute:
          Type: Lambda
        Configuration:
          Region: us-west-2
          CdkCliVersion: 2.130.0
  DeployBackend:
    Identifier: aws/cdk-deploy@v1
    Environment:
      Name: development
    Inputs:
      Sources:
        - WorkflowSource
      Variables:
        - Name: AWS_DEFAULT_REGION
          Value: us-west-2
        - Name: CDK_DEFAULT_ACCOUNT
          Value: "402377214432"
        - Name: CDK_DEFAULT_REGION
          Value: us-west-2
    Compute:
      Type: Lambda
    Configuration:
      StackName: ThumbnailServiceCdkStack
      Region: us-west-2
      CdkCliVersion: 2.130.0
      Context: '{"environment":"development"}'
    DependsOn:
      - Build
